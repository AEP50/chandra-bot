---
title: "Make Bot Inputs"
output: html_notebook
---

# Overhead
```{r overhead, include = FALSE}
packages_vector <- c("tidyverse",
                     "readxl")

need_to_install <- packages_vector[!(packages_vector %in% installed.packages()[,"Package"])]

if (length(need_to_install)) install.packages(need_to_install)

for (package in packages_vector) {
  library(package, character.only = TRUE)
}

```

# Remote I-O
```{r remote-io}
confidential_dir <- "~/Documents/Confidential/"

input_filename <- paste0(confidential_dir, "AEP50_ReviewerComments-9-15-2022.xlsx")

output_filename <- paste0(confidential_dir, "interim-review-summaries.csv")
```

# Parameters
```{r parameters}

```

# Data Reads
```{r data-reads}
raw_df <- readxl::read_xlsx(input_filename, 
                            skip = 3, 
                            col_names = c("paper_id", 
                                          "presentation_publish",
                                          "required_reviews",
                                          "review_id",
                                          "confidential_comments",
                                          "comments_to_author",
                                          "recommendation",
                                          "review_complete",
                                          "editorial_status",
                                          "Conclusion is valid and properly supported",
                                          "Data are valid relevant and contribute to the findings",
                                          "Does the abstract clearly communicate the scope and outcome of the study?",
                                          "Existing work well described and referenced",
                                          "How strongly would you recommend this for presentation at the annual meeting?",
                                          "How strongly would you recommend this paper for publication consideration by the Editorial Board?",
                                          "Important contribution to the state of the art or practice?",
                                          "Is the narrative clear and easy to understand?",
                                          "Methodology sufficiently explained for a knowledgeable reader to repeat the study?"))
                                          
                                          
                                          
                                    
```

# Reductions
```{r add-authors}
paper_id_df <- raw_df %>%
  select(paper_id) %>%
  filter(str_detect(paper_id, "TRBAM-"))

titles_df <- raw_df %>%
  select(paper_id) %>%
  filter(!(str_detect(paper_id, "TRBAM-"))) %>%
  distinct(paper_id) %>%
  rename(paper_title = paper_id) %>%
  filter(paper_title != "Article Title")

output_df <- raw_df %>%
  filter(!(str_detect(paper_id, "TRBAM-"))) %>%
  rename(paper_title = paper_id) %>%
  filter(paper_title != "Article Title") %>%
  left_join(., bind_cols(paper_id_df, titles_df), by = c("paper_title")) %>%
  select(paper_id, everything())
  

```

# Write to Disk
```{r write-data}
write_csv(output_df, output_filename)

```


